$("#password_value").val("");var timespan=1411093327735-(new Date).getTime();var passporttimeout;var upwd="";var eventTracking=$("#eventTracking").val();function getTokenId(){if(TDC&&TDC.getInfo&&TDC.getInfo().tokenid){return TDC.getInfo().tokenid}else{return"-1"}}function achievecode(){var vcodekey=$("#vcodekeyUser").val();var time=+new Date;var vcodeimgurl="//passport.58.com/validcode/get?vcodekey="+vcodekey+"&time="+time;$("#vcodeImg").attr("src",vcodeimgurl)}function QtoB(a){for(var c="",d=0;d<a.length;d++){c+=a.charCodeAt(d)==12288?String.fromCharCode(a.charCodeAt(d)-12256):a.charCodeAt(d)>65280&&a.charCodeAt(d)<65375?String.fromCharCode(a.charCodeAt(d)-65248):String.fromCharCode(a.charCodeAt(d))}return c}function GetCookieValue(c){var a=document.cookie.match(new RegExp(c+"=([^&;]+)"));if(a!=null){return decodeURI(a[1])}return""}$.fn.placeholder=function(){$(this).bind("focus",function(){$(this).removeClass("wronginputUser").addClass("achtiveblurinputUser")})};var usernameTip=$("#usernameTip");var passwordTip=$("#passwordTip");var validcodeTip=$("#validcodeTip");$("#usernameUser").placeholder();$("#passwordUser").placeholder();function checkoutUsername(){var usernameval=$("#usernameUser").val();if(usernameval=="手机号/账户名/邮箱"){usernameTip.html("您还没有输入账户名").addClass("errorTip").removeClass("rightTip");$(this).addClass("wronginputUser").removeClass("achtiveblurinputUser");return false}else if(!/[\w|\u4e00-\u9fa5|\@|\.|\-]{2,40}$/.test(usernameval)){usernameTip.html("用户名格式错误").addClass("errorTip").removeClass("rightTip");$(this).addClass("wronginputUser").removeClass("achtiveblurinputUser");return false}else{usernameTip.html("").removeClass("errorTip").addClass("rightTip");$(this).removeClass("wronginputUser").removeClass("achtiveblurinputUser");return true}}function checkoutPassword(){var passwordval=$("#passwordUser").val();if(passwordval.length==0){passwordTip.html("您还没有输入密码").addClass("errorTip").removeClass("rightTip");$(this).addClass("wronginputUser").removeClass("achtiveblurinputUser");return false}else if(passwordval.length>0&&passwordval.length<6){passwordTip.html("密码太短，最少为6位").addClass("errorTip").removeClass("rightTip");$(this).addClass("wronginputUser").removeClass("achtiveblurinputUser");return false}else if(passwordval.length>16){passwordTip.html("密码不应超过16个字符").addClass("errorTip").removeClass("rightTip");$(this).removeClass("achtiveblurinputUser");return false}else{passwordTip.html("").removeClass("errorTip").addClass("rightTip");$(this).removeClass("wronginputUser").removeClass("achtiveblurinputUser");return true}}function checkoutValidate(){var validateCodeVal=$("#validateCodeUser").val();if(validateCodeVal==""){validcodeTip.html("请输入验证码").addClass("errorTip").removeClass("rightTip");$(this).addClass("wronginputUser").removeClass("achtiveblurinputUser");return false}else{validcodeTip.html("").removeClass("errorTip").addClass("rightTip");$(this).removeClass("wronginputUser").removeClass("achtiveblurinputUser");return true}}if($("#usernameUser").val()==""){$("#usernameUser").val("手机号/账户名/邮箱").addClass("inputNull")}else{$("#usernameUser").removeClass("inputNull")}if($("#passwordUser").val()==""){$("#passwordUserText").show().val("密码").addClass("inputNull");$("#passwordUser").removeClass("inputNull").hide()}else{$("#passwordUserText").hide();$("#passwordUser").show();$("#passwordUser").removeClass("inputNull")}$("#usernameUser").bind("blur",function(){if($("#usernameUser").val()==""){$("#usernameUser").val("手机号/账户名/邮箱").addClass("inputNull")}checkoutUsername()}).bind("change",function(){$(this).val(QtoB(this.value))}).bind("focus",function(){if($("#usernameUser").val()=="手机号/账户名/邮箱"){$("#usernameUser").val("").removeClass("inputNull")}});$("#passwordUserText").bind("focus",function(){$("#passwordUserText").hide();$("#passwordUser").show();$("#passwordUser")[0].focus()});$("#passwordUser").bind("blur",function(){checkoutPassword();if($("#passwordUser").val()==""){$("#passwordUserText").show();$("#passwordUser").hide()}}).bind("change",function(){upwd=$(this).val()});$("#validateCodeUser").bind("blur",function(){if($("#isvalidcode").val()=="true"){checkoutValidate()}}).bind("blur",function(){$(this).val(QtoB(this.value))});$("#isremember_id_new").bind("click",function(){if($("#isremember_id_new").attr("checked")){$("#isrememberUser").val("true");var md="from=PC_login_zm_zddl"+eventTracking;clickLog(md)}else{$("#isrememberUser").val("false")}});$("#vcodeImg").bind("click",function(){achievecode()});$(".validatacodeaUser").bind("click",function(){achievecode()});$("#vcodeImgUser").bind("click",function(){achievecode()});$(".validatacodeaUser").bind("click",function(){achievecode()});$("#btnSubmitUser").bind("click",function(){var md="from=PC_login_zm_dldj"+eventTracking;clickLog(md);if(!checkoutUsername()){return false}if(!checkoutPassword()){return false}if(!checkoutValidate()&&$("#isvalidcode").val()=="true"){return false}var timesign=(new Date).getTime()+timespan;$("#p1User").val(encryptString(timesign+encodeURIComponent($("#passwordUser").val()),$("#rsaExponent").val(),$("#rsaModulus").val()));$("#password_value").val($("#passwordUser").val());$("#btnSubmitUser").val("登录中...");$("#usernameUser").addClass("fontcolor_cccUser").attr("readonly","readonly");$("#passwordUser").val("").addClass("fontcolor_cccUser").attr("readonly","readonly");if(typeof Fingerprint2!="undefined"){var fp=new Fingerprint2;var finger2=fp.get();$("#finger2").val(finger2)}else{$("#finger2").val("")}if(typeof fingerPrint!="undefined"){fingerPrint.get()}var md="from=PC_login_zm_dlqq"+eventTracking;clickLog(md);$("#getTokenIdUser").val(getTokenId());$("#submitFormUser").attr("target","formSubmitFrameUser")});function successFun(result){var source=$("#sourceUser").val();var path=$("#pathUser").val();var code=result.code;function clearform(){$("#btnSubmitUser").val("登录");$("#usernameUser").removeClass("fontcolor_cccUser").removeAttr("readonly");$("#passwordUser").removeClass("fontcolor_cccUser").removeAttr("readonly").val($("#password_value").val())}if($("#isvalidcode").val()=="true"){var errorTip=$("#validcodeTip")}else{var errorTip=$("#passwordTip")}if(code==0){var flick=$("#flick").val();var successFunction_username=$("#callback_others").val();var hasBind=$("#hasBind").val();if(successFunction_username==""){if(path==""){path="//my.58.com"}window.location.href=path}else{var callbackFunction_username=eval(successFunction_username);callbackFunction_username(result,path)}var md="from=PC_login_zm_dl"+eventTracking;clickLog(md);clearform()}else if(code==4){clearform();errorTip.html('为了保护您的账号，请使用<a class="gotoregUser" href="https://passport.58.com/pso/vipdunlogin">商盾登录</a>').addClass("errorTip").removeClass("rightTip");achievecode();return false}else if(code==2||code==3){clearform();var warnkey=result.data.warnkey;var warnkeypath=encodeURIComponent(path);var url="http://passport.58.com/warn/ui?source="+source+"&path="+warnkeypath+"&warnkey="+warnkey+"&win=pc";window.location.href=url;return false}else if(code==5){clearform();errorTip.html('该用户名不存在， <a class="gotoregUser" href="//passport.58.com/reg">立即注册?</a> ').addClass("errorTip").removeClass("rightTip");achievecode();return false}else if(code==-1||code==-2){clearform();validcodeTip.html("系统异常 请刷新页面").addClass("errorTip").removeClass("rightTip");achievecode();return false}else if(code==785){clearform();$("#isvalidcode").val("true");var vcodekey=result.data.vcodekey;validcodeTip.html("请输入验证码").removeClass("rightTip");$("#validcodeliUser").show();$("#vcodekeyUser").val(vcodekey);achievecode();return false}else if(code==786){$("#isvalidcode").val("true");clearform();achievecode();validcodeTip.html("验证码错误").addClass("errorTip").removeClass("rightTip")}else{var msg=result.msg;clearform();if($("#isvalidcode").val()=="true"){validcodeTip.html(msg).addClass("errorTip").removeClass("rightTip");achievecode()}else{passwordTip.html(msg).addClass("errorTip").removeClass("rightTip")}return false}}